---
import { getCollection, render } from "astro:content"
import ContentPage from "../../../../layouts/ContentPage.astro"
export const prerender = true
export async function getStaticPaths() {
	const posts = await getCollection("help")
	const processed = posts
		.filter((post) => {
			return post.id.split("/").length == 2
		})
		.map((post) => {
			return {
				params: {
					id: post.id.split("/")[2],
					category: post.id.split("/")[1],
					language: post.id.split("/")[0],
				},
				props: { post },
			}
		})
	return processed
}
const { post } = Astro.props
const { category, language } = Astro.params
const { Content } = await render(post)
---

<ContentPage title={post.data.title} includeH1={false} description={post.data.summary} noIndex={post.data.noIndex} language={language}>
	<Content />
	<ul>
		{
			await getCollection("help").then((posts) => {
				return posts.map((post) => {
					if (post.id.includes(`${language}/${category}/`)) {
						return (
							<li>
									<a href={`./${category}/${post.id.split("/")[2]}`}>{post.data.title}</a> {post.data.summary}
							</li>
						)
					}
				})
			})
		}
	</ul>
	<p><a href=`../${language}`>Help index</a></p>
</ContentPage>
